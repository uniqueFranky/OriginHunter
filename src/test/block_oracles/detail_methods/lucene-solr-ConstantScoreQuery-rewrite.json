{
  "origin": "codeshovel",
  "repositoryName": "lucene-solr",
  "repositoryPath": "/Users/franky/Documents/Homework/毕业设计/testcase/lucene-solr/.git",
  "startCommitName": "38bf976cd4b9e324c21664bd7ae3d554df803705",
  "sourceFileName": "ConstantScoreQuery.java",
  "functionName": "rewrite",
  "functionId": "rewrite___reader-IndexReader",
  "sourceFilePath": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
  "functionAnnotation": "@Override",
  "functionDoc": "",
  "functionStartLine": 49,
  "functionEndLine": 65,
  "numCommitsSeen": 89,
  "timeTaken": 3050,
  "changeHistory": [
    "962313b83ba9c69379e1f84dffc881a361713ce9",
    "1422c4607f30cb576333ac6fba7f864d8e9fdc4a",
    "82eff4eb4de76ff641ddd603d9b8558a4277644d",
    "e45d67083e642ad21c9dc337637b53d55da94964",
    "eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c",
    "adfabc3df71f372a5c968d61e9167890388d24fd",
    "778d96752fa94636a2136ea2b4d58a3fcbe283ec",
    "00f4efde1fe23f1190e322adb20b8065c591e5d6",
    "fd41195ef316b9ff2f1721d259c2bbeedf1a1ff0"
  ],
  "changeHistoryShort": {
    "962313b83ba9c69379e1f84dffc881a361713ce9": "Ybodychange",
    "1422c4607f30cb576333ac6fba7f864d8e9fdc4a": "Ybodychange",
    "82eff4eb4de76ff641ddd603d9b8558a4277644d": "Ybodychange",
    "e45d67083e642ad21c9dc337637b53d55da94964": "Ybodychange",
    "eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c": "Yfilerename",
    "adfabc3df71f372a5c968d61e9167890388d24fd": "Ybodychange",
    "778d96752fa94636a2136ea2b4d58a3fcbe283ec": "Yfilerename",
    "00f4efde1fe23f1190e322adb20b8065c591e5d6": "Yannotationchange",
    "fd41195ef316b9ff2f1721d259c2bbeedf1a1ff0": "Yintroduced"
  },
  "changeHistoryDetails": {
    "962313b83ba9c69379e1f84dffc881a361713ce9": {
      "type": "Ybodychange",
      "commitMessage": "LUCENE-6590: Replace Query.getBoost, setBoost and clone with a new BoostQuery.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1701621 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2015/9/7 下午9:34",
      "commitName": "962313b83ba9c69379e1f84dffc881a361713ce9",
      "commitAuthor": "Adrien Grand",
      "commitDateOld": "2015/6/25 下午9:59",
      "commitNameOld": "d671dd8d890a8e5eb56cbcd94873c3057745a17f",
      "commitAuthorOld": "Adrien Grand",
      "daysBetweenCommits": 73.98,
      "commitsBetweenForRepo": 438,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    Query rewritten \u003d query.rewrite(reader);\n    if (rewritten !\u003d query) {\n        return new ConstantScoreQuery(rewritten);\n    }\n    if (rewritten.getClass() \u003d\u003d ConstantScoreQuery.class) {\n        return rewritten;\n    }\n    if (rewritten.getClass() \u003d\u003d BoostQuery.class) {\n        return new ConstantScoreQuery(((BoostQuery) rewritten).getQuery());\n    }\n    return super.rewrite(reader);\n}",
      "path": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 49,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,17 +1,14 @@\n @Override\n public Query rewrite(IndexReader reader) throws IOException {\n     Query rewritten \u003d query.rewrite(reader);\n-    if (rewritten.getClass() \u003d\u003d getClass()) {\n-        if (getBoost() !\u003d rewritten.getBoost()) {\n-            rewritten \u003d rewritten.clone();\n-            rewritten.setBoost(getBoost());\n-        }\n-        return rewritten;\n-    }\n     if (rewritten !\u003d query) {\n-        rewritten \u003d new ConstantScoreQuery(rewritten);\n-        rewritten.setBoost(this.getBoost());\n+        return new ConstantScoreQuery(rewritten);\n+    }\n+    if (rewritten.getClass() \u003d\u003d ConstantScoreQuery.class) {\n         return rewritten;\n     }\n-    return this;\n+    if (rewritten.getClass() \u003d\u003d BoostQuery.class) {\n+        return new ConstantScoreQuery(((BoostQuery) rewritten).getQuery());\n+    }\n+    return super.rewrite(reader);\n }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "1422c4607f30cb576333ac6fba7f864d8e9fdc4a": {
      "type": "Ybodychange",
      "commitMessage": "LUCENE-6448: Make Filter a better Query citizen.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1675199 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2015/4/22 上午4:56",
      "commitName": "1422c4607f30cb576333ac6fba7f864d8e9fdc4a",
      "commitAuthor": "Adrien Grand",
      "commitDateOld": "2015/4/21 下午8:55",
      "commitNameOld": "c6821e1a1941e9ed6cbe35a3cb5be831bb6cfe1a",
      "commitAuthorOld": "Adrien Grand",
      "daysBetweenCommits": 0.33,
      "commitsBetweenForRepo": 6,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    Query rewritten \u003d query.rewrite(reader);\n    if (rewritten.getClass() \u003d\u003d getClass()) {\n        if (getBoost() !\u003d rewritten.getBoost()) {\n            rewritten \u003d rewritten.clone();\n            rewritten.setBoost(getBoost());\n        }\n        return rewritten;\n    }\n    if (rewritten !\u003d query) {\n        rewritten \u003d new ConstantScoreQuery(rewritten);\n        rewritten.setBoost(this.getBoost());\n        return rewritten;\n    }\n    return this;\n}",
      "path": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 52,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,14 +1,17 @@\n @Override\n public Query rewrite(IndexReader reader) throws IOException {\n-    Query sub \u003d query;\n-    if (sub instanceof QueryWrapperFilter) {\n-        sub \u003d ((QueryWrapperFilter) sub).getQuery();\n+    Query rewritten \u003d query.rewrite(reader);\n+    if (rewritten.getClass() \u003d\u003d getClass()) {\n+        if (getBoost() !\u003d rewritten.getBoost()) {\n+            rewritten \u003d rewritten.clone();\n+            rewritten.setBoost(getBoost());\n+        }\n+        return rewritten;\n     }\n-    Query rewritten \u003d sub.rewrite(reader);\n     if (rewritten !\u003d query) {\n         rewritten \u003d new ConstantScoreQuery(rewritten);\n         rewritten.setBoost(this.getBoost());\n         return rewritten;\n     }\n     return this;\n }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "82eff4eb4de76ff641ddd603d9b8558a4277644d": {
      "type": "Ybodychange",
      "commitMessage": "LUCENE-1518: Make Filter extend Query.\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1659585 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2015/2/13 下午11:59",
      "commitName": "82eff4eb4de76ff641ddd603d9b8558a4277644d",
      "commitAuthor": "Adrien Grand",
      "commitDateOld": "2015/2/9 下午8:02",
      "commitNameOld": "e0ff51383cef314cd65a4c54028ac7146379eba3",
      "commitAuthorOld": "Alan Woodward",
      "daysBetweenCommits": 4.16,
      "commitsBetweenForRepo": 43,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    Query sub \u003d query;\n    if (sub instanceof QueryWrapperFilter) {\n        sub \u003d ((QueryWrapperFilter) sub).getQuery();\n    }\n    Query rewritten \u003d sub.rewrite(reader);\n    if (rewritten !\u003d query) {\n        rewritten \u003d new ConstantScoreQuery(rewritten);\n        rewritten.setBoost(this.getBoost());\n        return rewritten;\n    }\n    return this;\n}",
      "path": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 52,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,20 +1,14 @@\n @Override\n public Query rewrite(IndexReader reader) throws IOException {\n-    if (query !\u003d null) {\n-        Query rewritten \u003d query.rewrite(reader);\n-        if (rewritten !\u003d query) {\n-            rewritten \u003d new ConstantScoreQuery(rewritten);\n-            rewritten.setBoost(this.getBoost());\n-            return rewritten;\n-        }\n-    } else {\n-        assert filter !\u003d null;\n-        if (filter instanceof QueryWrapperFilter) {\n-            final QueryWrapperFilter qwf \u003d (QueryWrapperFilter) filter;\n-            final Query rewritten \u003d new ConstantScoreQuery(qwf.getQuery().rewrite(reader));\n-            rewritten.setBoost(this.getBoost());\n-            return rewritten;\n-        }\n+    Query sub \u003d query;\n+    if (sub instanceof QueryWrapperFilter) {\n+        sub \u003d ((QueryWrapperFilter) sub).getQuery();\n+    }\n+    Query rewritten \u003d sub.rewrite(reader);\n+    if (rewritten !\u003d query) {\n+        rewritten \u003d new ConstantScoreQuery(rewritten);\n+        rewritten.setBoost(this.getBoost());\n+        return rewritten;\n     }\n     return this;\n }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "e45d67083e642ad21c9dc337637b53d55da94964": {
      "type": "Ybodychange",
      "commitMessage": "LUCENE-5307: Fix topScorer inconsistency in handling QueryWrapperFilter inside ConstantScoreQuery, which now rewrites to a query removing the obsolete QueryWrapperFilter\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1535950 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2013/10/26 下午5:12",
      "commitName": "e45d67083e642ad21c9dc337637b53d55da94964",
      "commitAuthor": "Uwe Schindler",
      "commitDateOld": "2013/3/15 上午4:48",
      "commitNameOld": "2c64eb9019e3815259e4cd013c47a930a22f8e0d",
      "commitAuthorOld": "Robert Muir",
      "daysBetweenCommits": 225.52,
      "commitsBetweenForRepo": 1524,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    if (query !\u003d null) {\n        Query rewritten \u003d query.rewrite(reader);\n        if (rewritten !\u003d query) {\n            rewritten \u003d new ConstantScoreQuery(rewritten);\n            rewritten.setBoost(this.getBoost());\n            return rewritten;\n        }\n    } else {\n        assert filter !\u003d null;\n        if (filter instanceof QueryWrapperFilter) {\n            final QueryWrapperFilter qwf \u003d (QueryWrapperFilter) filter;\n            final Query rewritten \u003d new ConstantScoreQuery(qwf.getQuery().rewrite(reader));\n            rewritten.setBoost(this.getBoost());\n            return rewritten;\n        }\n    }\n    return this;\n}",
      "path": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 73,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,12 +1,20 @@\n @Override\n public Query rewrite(IndexReader reader) throws IOException {\n     if (query !\u003d null) {\n         Query rewritten \u003d query.rewrite(reader);\n         if (rewritten !\u003d query) {\n             rewritten \u003d new ConstantScoreQuery(rewritten);\n             rewritten.setBoost(this.getBoost());\n             return rewritten;\n         }\n+    } else {\n+        assert filter !\u003d null;\n+        if (filter instanceof QueryWrapperFilter) {\n+            final QueryWrapperFilter qwf \u003d (QueryWrapperFilter) filter;\n+            final Query rewritten \u003d new ConstantScoreQuery(qwf.getQuery().rewrite(reader));\n+            rewritten.setBoost(this.getBoost());\n+            return rewritten;\n+        }\n     }\n     return this;\n }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c": {
      "type": "Yfilerename",
      "commitMessage": "LUCENE-3753: Restructure the Lucene build system\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1241588 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2012/2/8 上午3:59",
      "commitName": "eb0ab3d392a42c1835f79bcd7f5404bcc50c8e4c",
      "commitAuthor": "Steven Rowe",
      "commitDateOld": "2012/2/8 上午2:58",
      "commitNameOld": "8b939cb7d20160f9f8a7baf2030613f0e1e877b4",
      "commitAuthorOld": "Robert Muir",
      "daysBetweenCommits": 0.04,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    if (query !\u003d null) {\n        Query rewritten \u003d query.rewrite(reader);\n        if (rewritten !\u003d query) {\n            rewritten \u003d new ConstantScoreQuery(rewritten);\n            rewritten.setBoost(this.getBoost());\n            return rewritten;\n        }\n    }\n    return this;\n}",
      "path": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 71,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "",
      "extendedDetails": {
        "oldPath": "lucene/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
        "newPath": "lucene/core/src/java/org/apache/lucene/search/ConstantScoreQuery.java"
      }
    },
    "adfabc3df71f372a5c968d61e9167890388d24fd": {
      "type": "Ybodychange",
      "commitMessage": "LUCENE-2838: ConstantScoreQuery now directly supports wrapping a Query instance for stripping off scores\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/dev/trunk@1054406 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2011/1/2 下午9:47",
      "commitName": "adfabc3df71f372a5c968d61e9167890388d24fd",
      "commitAuthor": "Uwe Schindler",
      "commitDateOld": "2010/9/1 上午3:50",
      "commitNameOld": "5fe8094027995a408e474be6f50d27831ec5463c",
      "commitAuthorOld": "Simon Willnauer",
      "daysBetweenCommits": 123.75,
      "commitsBetweenForRepo": 746,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    if (query !\u003d null) {\n        Query rewritten \u003d query.rewrite(reader);\n        if (rewritten !\u003d query) {\n            rewritten \u003d new ConstantScoreQuery(rewritten);\n            rewritten.setBoost(this.getBoost());\n            return rewritten;\n        }\n    }\n    return this;\n}",
      "path": "lucene/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 75,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,4 +1,12 @@\n @Override\n public Query rewrite(IndexReader reader) throws IOException {\n+    if (query !\u003d null) {\n+        Query rewritten \u003d query.rewrite(reader);\n+        if (rewritten !\u003d query) {\n+            rewritten \u003d new ConstantScoreQuery(rewritten);\n+            rewritten.setBoost(this.getBoost());\n+            return rewritten;\n+        }\n+    }\n     return this;\n }\n\\ No newline at end of file\n",
      "extendedDetails": {}
    },
    "778d96752fa94636a2136ea2b4d58a3fcbe283ec": {
      "type": "Yfilerename",
      "commitMessage": "SVN-GIT conversion, path copy emulation.\n",
      "commitDate": "2016/1/23 上午8:18",
      "commitName": "778d96752fa94636a2136ea2b4d58a3fcbe283ec",
      "commitAuthor": "Dawid Weiss",
      "commitDateOld": "2010/3/17 下午10:57",
      "commitNameOld": "2e5c6cdadc820220f8cb86e1b6e215da941649f9",
      "commitAuthorOld": "Uwe Schindler",
      "daysBetweenCommits": 2137.39,
      "commitsBetweenForRepo": 1,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    return this;\n}",
      "path": "lucene/src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 43,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "",
      "extendedDetails": {
        "oldPath": "src/java/org/apache/lucene/search/ConstantScoreQuery.java",
        "newPath": "lucene/src/java/org/apache/lucene/search/ConstantScoreQuery.java"
      }
    },
    "00f4efde1fe23f1190e322adb20b8065c591e5d6": {
      "type": "Yannotationchange",
      "commitMessage": "LUCENE-2011: Remove deprecated Scorer.explain(int) and replace by Weight.explain(IR,int) calls in tests and PhraseQuery/SpanQuery explanations methods\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/java/trunk@830377 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2009/10/28 上午6:29",
      "commitName": "00f4efde1fe23f1190e322adb20b8065c591e5d6",
      "commitAuthor": "Uwe Schindler",
      "commitDateOld": "2009/10/13 上午6:40",
      "commitNameOld": "9b9d85d9ca244f2061111f2db825aa89a9f84793",
      "commitAuthorOld": "Michael Busch",
      "daysBetweenCommits": 14.99,
      "commitsBetweenForRepo": 102,
      "commitsBetweenForFile": 1,
      "actualSource": "@Override\npublic Query rewrite(IndexReader reader) throws IOException {\n    return this;\n}",
      "path": "src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 43,
      "functionName": "rewrite",
      "functionAnnotation": "@Override",
      "functionDoc": "",
      "diff": "@@ -1,3 +1,4 @@\n+@Override\n public Query rewrite(IndexReader reader) throws IOException {\n     return this;\n }\n\\ No newline at end of file\n",
      "extendedDetails": {
        "oldValue": "",
        "newValue": "@Override"
      }
    },
    "fd41195ef316b9ff2f1721d259c2bbeedf1a1ff0": {
      "type": "Yintroduced",
      "commitMessage": "ConstantScoreRangeQuery addition: LUCENE-383\n\ngit-svn-id: https://svn.apache.org/repos/asf/lucene/java/trunk@344312 13f79535-47bb-0310-9956-ffa450edef68\n",
      "commitDate": "2005/11/15 下午1:28",
      "commitName": "fd41195ef316b9ff2f1721d259c2bbeedf1a1ff0",
      "commitAuthor": "Yonik Seeley",
      "diff": "@@ -0,0 +1,3 @@\n+public Query rewrite(IndexReader reader) throws IOException {\n+    return this;\n+}\n\\ No newline at end of file\n",
      "actualSource": "public Query rewrite(IndexReader reader) throws IOException {\n    return this;\n}",
      "path": "src/java/org/apache/lucene/search/ConstantScoreQuery.java",
      "functionStartLine": 38,
      "functionName": "rewrite",
      "functionAnnotation": "",
      "functionDoc": ""
    }
  }
}