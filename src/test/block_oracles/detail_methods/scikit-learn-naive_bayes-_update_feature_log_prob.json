{
  "origin": "codeshovel",
  "repositoryName": "scikit-learn",
  "repositoryPath": "/Users/franky/Documents/Homework/毕业设计/testcase/scikit-learn/.git",
  "startCommitName": "9e5819aa413ce907134ee5704abba43ad8a61827",
  "sourceFileName": "naive_bayes.py",
  "functionName": "_update_feature_log_prob",
  "functionId": "BernoulliNB___update_feature_log_prob___self__alpha",
  "sourceFilePath": "sklearn/naive_bayes.py",
  "functionAnnotation": "",
  "functionStartLine": 1001,
  "functionEndLine": 1008,
  "numCommitsSeen": 348,
  "timeTaken": 4231,
  "changeHistory": [
    "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f",
    "e073432fc6cf93a765f78934fba5639f0174e3a6",
    "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
    "02cdd92f98c0e96f6fd02d81a1c57c7921e35273"
  ],
  "changeHistoryShort": {
    "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f": "Ymultichange(Yparameterchange,Ybodychange)",
    "e073432fc6cf93a765f78934fba5639f0174e3a6": "Ybodychange",
    "ef17c8b47e6f1de1d322028f82c2283c0a73b177": "Ymultichange(Ymovefromfile,Ybodychange,Yrename,Yparameterchange)",
    "02cdd92f98c0e96f6fd02d81a1c57c7921e35273": "Yintroduced"
  },
  "changeHistoryDetails": {
    "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f": {
      "type": "Ymultichange(Yparameterchange,Ybodychange)",
      "commitMessage": "[MRG+1] Fix MultinomialNB and BernoulliNB alpha\u003d0 bug (continuation) (#9131)\n\n* Fix #5814\r\n\r\n* Fix pep8 in naive_bayes.py:716\r\n\r\n* Fix sparse matrix incompatibility\r\n\r\n* Fix python 2.7 problem in test_naive_bayes\r\n\r\n* Make sure the values are probabilities before log transform\r\n\r\n* Improve docstring of  `_safe_logprob`\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha in fit and partial_fit\r\n\r\n* Add what\u0027s new entry\r\n\r\n* Add test\r\n\r\n* Remove .project\r\n\r\n* Replace assert method\r\n\r\n* Update what\u0027s new\r\n\r\n* Format float into %.1e\r\n\r\n* Update ValueError msg\r\n",
      "commitDate": "2017/6/20 上午3:33",
      "commitName": "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f",
      "commitAuthor": "RAKOTOARISON Herilalaina",
      "subchanges": [
        {
          "type": "Yparameterchange",
          "commitMessage": "[MRG+1] Fix MultinomialNB and BernoulliNB alpha\u003d0 bug (continuation) (#9131)\n\n* Fix #5814\r\n\r\n* Fix pep8 in naive_bayes.py:716\r\n\r\n* Fix sparse matrix incompatibility\r\n\r\n* Fix python 2.7 problem in test_naive_bayes\r\n\r\n* Make sure the values are probabilities before log transform\r\n\r\n* Improve docstring of  `_safe_logprob`\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha in fit and partial_fit\r\n\r\n* Add what\u0027s new entry\r\n\r\n* Add test\r\n\r\n* Remove .project\r\n\r\n* Replace assert method\r\n\r\n* Update what\u0027s new\r\n\r\n* Format float into %.1e\r\n\r\n* Update ValueError msg\r\n",
          "commitDate": "2017/6/20 上午3:33",
          "commitName": "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f",
          "commitAuthor": "RAKOTOARISON Herilalaina",
          "commitDateOld": "2017/6/10 下午9:01",
          "commitNameOld": "95aa2952e1544a5a2e0f14d366bae1bfd8e9195a",
          "commitAuthorOld": "Naoya Kanai",
          "daysBetweenCommits": 9.27,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self, alpha):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        smoothed_fc \u003d self.feature_count_ + alpha\n        smoothed_cc \u003d self.class_count_ + alpha * 2\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc) -\n                                  np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 814,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,7 +1,7 @@\n-    def _update_feature_log_prob(self):\n+    def _update_feature_log_prob(self, alpha):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n-        smoothed_fc \u003d self.feature_count_ + self.alpha\n-        smoothed_cc \u003d self.class_count_ + self.alpha * 2\n+        smoothed_fc \u003d self.feature_count_ + alpha\n+        smoothed_cc \u003d self.class_count_ + alpha * 2\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc) -\n                                   np.log(smoothed_cc.reshape(-1, 1)))\n",
          "extendedDetails": {
            "oldValue": "[self]",
            "newValue": "[self, alpha]"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "[MRG+1] Fix MultinomialNB and BernoulliNB alpha\u003d0 bug (continuation) (#9131)\n\n* Fix #5814\r\n\r\n* Fix pep8 in naive_bayes.py:716\r\n\r\n* Fix sparse matrix incompatibility\r\n\r\n* Fix python 2.7 problem in test_naive_bayes\r\n\r\n* Make sure the values are probabilities before log transform\r\n\r\n* Improve docstring of  `_safe_logprob`\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha solution\r\n\r\n* Clip alpha in fit and partial_fit\r\n\r\n* Add what\u0027s new entry\r\n\r\n* Add test\r\n\r\n* Remove .project\r\n\r\n* Replace assert method\r\n\r\n* Update what\u0027s new\r\n\r\n* Format float into %.1e\r\n\r\n* Update ValueError msg\r\n",
          "commitDate": "2017/6/20 上午3:33",
          "commitName": "b4b5de8cf9748a07d8f3a2d1fc89ccaacdf6576f",
          "commitAuthor": "RAKOTOARISON Herilalaina",
          "commitDateOld": "2017/6/10 下午9:01",
          "commitNameOld": "95aa2952e1544a5a2e0f14d366bae1bfd8e9195a",
          "commitAuthorOld": "Naoya Kanai",
          "daysBetweenCommits": 9.27,
          "commitsBetweenForRepo": 43,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self, alpha):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        smoothed_fc \u003d self.feature_count_ + alpha\n        smoothed_cc \u003d self.class_count_ + alpha * 2\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc) -\n                                  np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 814,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,7 +1,7 @@\n-    def _update_feature_log_prob(self):\n+    def _update_feature_log_prob(self, alpha):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n-        smoothed_fc \u003d self.feature_count_ + self.alpha\n-        smoothed_cc \u003d self.class_count_ + self.alpha * 2\n+        smoothed_fc \u003d self.feature_count_ + alpha\n+        smoothed_cc \u003d self.class_count_ + alpha * 2\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc) -\n                                   np.log(smoothed_cc.reshape(-1, 1)))\n",
          "extendedDetails": {}
        }
      ]
    },
    "e073432fc6cf93a765f78934fba5639f0174e3a6": {
      "type": "Ybodychange",
      "commitMessage": "FIX issue #4268 (bug in BernoulliNB).\n",
      "commitDate": "2015/2/27 下午6:18",
      "commitName": "e073432fc6cf93a765f78934fba5639f0174e3a6",
      "commitAuthor": "Hanna Wallach",
      "commitDateOld": "2015/2/10 上午4:54",
      "commitNameOld": "6465b8dea1188c390b8e28080b6c9126793bbfec",
      "commitAuthorOld": "Raghav R V",
      "daysBetweenCommits": 17.56,
      "commitsBetweenForRepo": 71,
      "commitsBetweenForFile": 1,
      "actualSource": "    def _update_feature_log_prob(self):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * 2\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n",
      "path": "sklearn/naive_bayes.py",
      "functionStartLine": 702,
      "functionName": "_update_feature_log_prob",
      "functionAnnotation": "",
      "diff": "@@ -1,8 +1,7 @@\n     def _update_feature_log_prob(self):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n-        n_classes \u003d len(self.classes_)\n         smoothed_fc \u003d self.feature_count_ + self.alpha\n-        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n+        smoothed_cc \u003d self.class_count_ + self.alpha * 2\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                   - np.log(smoothed_cc.reshape(-1, 1)))\n",
      "extendedDetails": {}
    },
    "ef17c8b47e6f1de1d322028f82c2283c0a73b177": {
      "type": "Ymultichange(Ymovefromfile,Ybodychange,Yrename,Yparameterchange)",
      "commitMessage": "Add reference to the Manning text + restaure previous smoothing\n",
      "commitDate": "2013/7/25 下午4:21",
      "commitName": "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
      "commitAuthor": "Olivier Grisel",
      "subchanges": [
        {
          "type": "Ymovefromfile",
          "commitMessage": "Add reference to the Manning text + restaure previous smoothing\n",
          "commitDate": "2013/7/25 下午4:21",
          "commitName": "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
          "commitAuthor": "Olivier Grisel",
          "commitDateOld": "2013/7/25 下午4:21",
          "commitNameOld": "dea7f3fcc381a4a2c3fafd6484d0fd4a1a1aed40",
          "commitAuthorOld": "Olivier Grisel",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        n_classes \u003d len(self.classes_)\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 533,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,20 +1,8 @@\n-    def _update_log_probas(self, class_prior\u003dNone):\n+    def _update_feature_log_prob(self):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n         n_classes \u003d len(self.classes_)\n         smoothed_fc \u003d self.feature_count_ + self.alpha\n         smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                   - np.log(smoothed_cc.reshape(-1, 1)))\n-\n-        if class_prior is not None:\n-            if len(class_prior) !\u003d n_classes:\n-                raise ValueError(\"Number of priors must match number of\"\n-                                 \" classes.\")\n-            self.class_log_prior_ \u003d np.log(class_prior)\n-        elif self.fit_prior:\n-            # empirical prior, with sample_weight taken into account\n-            self.class_log_prior_ \u003d (np.log(self.class_count_)\n-                                     - np.log(self.class_count_.sum()))\n-        else:\n-            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
          "extendedDetails": {
            "oldPath": "sklearn/naive_bayes.py",
            "newPath": "sklearn/naive_bayes.py",
            "oldMethodName": "_update_log_probas",
            "newMethodName": "_update_feature_log_prob"
          }
        },
        {
          "type": "Ybodychange",
          "commitMessage": "Add reference to the Manning text + restaure previous smoothing\n",
          "commitDate": "2013/7/25 下午4:21",
          "commitName": "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
          "commitAuthor": "Olivier Grisel",
          "commitDateOld": "2013/7/25 下午4:21",
          "commitNameOld": "dea7f3fcc381a4a2c3fafd6484d0fd4a1a1aed40",
          "commitAuthorOld": "Olivier Grisel",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        n_classes \u003d len(self.classes_)\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 533,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,20 +1,8 @@\n-    def _update_log_probas(self, class_prior\u003dNone):\n+    def _update_feature_log_prob(self):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n         n_classes \u003d len(self.classes_)\n         smoothed_fc \u003d self.feature_count_ + self.alpha\n         smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                   - np.log(smoothed_cc.reshape(-1, 1)))\n-\n-        if class_prior is not None:\n-            if len(class_prior) !\u003d n_classes:\n-                raise ValueError(\"Number of priors must match number of\"\n-                                 \" classes.\")\n-            self.class_log_prior_ \u003d np.log(class_prior)\n-        elif self.fit_prior:\n-            # empirical prior, with sample_weight taken into account\n-            self.class_log_prior_ \u003d (np.log(self.class_count_)\n-                                     - np.log(self.class_count_.sum()))\n-        else:\n-            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
          "extendedDetails": {}
        },
        {
          "type": "Yrename",
          "commitMessage": "Add reference to the Manning text + restaure previous smoothing\n",
          "commitDate": "2013/7/25 下午4:21",
          "commitName": "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
          "commitAuthor": "Olivier Grisel",
          "commitDateOld": "2013/7/25 下午4:21",
          "commitNameOld": "dea7f3fcc381a4a2c3fafd6484d0fd4a1a1aed40",
          "commitAuthorOld": "Olivier Grisel",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        n_classes \u003d len(self.classes_)\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 533,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,20 +1,8 @@\n-    def _update_log_probas(self, class_prior\u003dNone):\n+    def _update_feature_log_prob(self):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n         n_classes \u003d len(self.classes_)\n         smoothed_fc \u003d self.feature_count_ + self.alpha\n         smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                   - np.log(smoothed_cc.reshape(-1, 1)))\n-\n-        if class_prior is not None:\n-            if len(class_prior) !\u003d n_classes:\n-                raise ValueError(\"Number of priors must match number of\"\n-                                 \" classes.\")\n-            self.class_log_prior_ \u003d np.log(class_prior)\n-        elif self.fit_prior:\n-            # empirical prior, with sample_weight taken into account\n-            self.class_log_prior_ \u003d (np.log(self.class_count_)\n-                                     - np.log(self.class_count_.sum()))\n-        else:\n-            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
          "extendedDetails": {
            "oldValue": "_update_log_probas",
            "newValue": "_update_feature_log_prob"
          }
        },
        {
          "type": "Yparameterchange",
          "commitMessage": "Add reference to the Manning text + restaure previous smoothing\n",
          "commitDate": "2013/7/25 下午4:21",
          "commitName": "ef17c8b47e6f1de1d322028f82c2283c0a73b177",
          "commitAuthor": "Olivier Grisel",
          "commitDateOld": "2013/7/25 下午4:21",
          "commitNameOld": "dea7f3fcc381a4a2c3fafd6484d0fd4a1a1aed40",
          "commitAuthorOld": "Olivier Grisel",
          "daysBetweenCommits": 0.0,
          "commitsBetweenForRepo": 1,
          "commitsBetweenForFile": 1,
          "actualSource": "    def _update_feature_log_prob(self):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        n_classes \u003d len(self.classes_)\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n",
          "path": "sklearn/naive_bayes.py",
          "functionStartLine": 533,
          "functionName": "_update_feature_log_prob",
          "functionAnnotation": "",
          "diff": "@@ -1,20 +1,8 @@\n-    def _update_log_probas(self, class_prior\u003dNone):\n+    def _update_feature_log_prob(self):\n         \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n         n_classes \u003d len(self.classes_)\n         smoothed_fc \u003d self.feature_count_ + self.alpha\n         smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n \n         self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                   - np.log(smoothed_cc.reshape(-1, 1)))\n-\n-        if class_prior is not None:\n-            if len(class_prior) !\u003d n_classes:\n-                raise ValueError(\"Number of priors must match number of\"\n-                                 \" classes.\")\n-            self.class_log_prior_ \u003d np.log(class_prior)\n-        elif self.fit_prior:\n-            # empirical prior, with sample_weight taken into account\n-            self.class_log_prior_ \u003d (np.log(self.class_count_)\n-                                     - np.log(self.class_count_.sum()))\n-        else:\n-            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
          "extendedDetails": {
            "oldValue": "[self, class_prior(default-None)]",
            "newValue": "[self]"
          }
        }
      ]
    },
    "02cdd92f98c0e96f6fd02d81a1c57c7921e35273": {
      "type": "Yintroduced",
      "commitMessage": "WIP: started to factorized the raw count collection\n",
      "commitDate": "2013/7/25 下午4:21",
      "commitName": "02cdd92f98c0e96f6fd02d81a1c57c7921e35273",
      "commitAuthor": "Olivier Grisel",
      "diff": "@@ -0,0 +1,20 @@\n+    def _update_log_probas(self, class_prior\u003dNone):\n+        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n+        n_classes \u003d len(self.classes_)\n+        smoothed_fc \u003d self.feature_count_ + self.alpha\n+        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n+\n+        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n+                                  - np.log(smoothed_cc.reshape(-1, 1)))\n+\n+        if class_prior is not None:\n+            if len(class_prior) !\u003d n_classes:\n+                raise ValueError(\"Number of priors must match number of\"\n+                                 \" classes.\")\n+            self.class_log_prior_ \u003d np.log(class_prior)\n+        elif self.fit_prior:\n+            # empirical prior, with sample_weight taken into account\n+            self.class_log_prior_ \u003d (np.log(self.class_count_)\n+                                     - np.log(self.class_count_.sum()))\n+        else:\n+            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
      "actualSource": "    def _update_log_probas(self, class_prior\u003dNone):\n        \"\"\"Apply smoothing to raw counts and recompute log probabilities\"\"\"\n        n_classes \u003d len(self.classes_)\n        smoothed_fc \u003d self.feature_count_ + self.alpha\n        smoothed_cc \u003d self.class_count_ + self.alpha * n_classes\n\n        self.feature_log_prob_ \u003d (np.log(smoothed_fc)\n                                  - np.log(smoothed_cc.reshape(-1, 1)))\n\n        if class_prior is not None:\n            if len(class_prior) !\u003d n_classes:\n                raise ValueError(\"Number of priors must match number of\"\n                                 \" classes.\")\n            self.class_log_prior_ \u003d np.log(class_prior)\n        elif self.fit_prior:\n            # empirical prior, with sample_weight taken into account\n            self.class_log_prior_ \u003d (np.log(self.class_count_)\n                                     - np.log(self.class_count_.sum()))\n        else:\n            self.class_log_prior_ \u003d np.zeros(n_classes) - np.log(n_classes)\n",
      "path": "sklearn/naive_bayes.py",
      "functionStartLine": 198,
      "functionName": "_update_log_probas",
      "functionAnnotation": ""
    }
  }
}